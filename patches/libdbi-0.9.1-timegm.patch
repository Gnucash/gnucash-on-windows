--- a/src/dbi_result.c	2021-10-25 10:39:45.000000000 -0700
+++ b/src/dbi_result.c	2025-09-16 13:11:00.180014900 -0700
@@ -1364,8 +1364,12 @@
 {
 	struct tm copy = dtx->tm;
 
+#ifdef __WIN32
+        return _mkgmtime(&copy) - dtx->utc_offset;
+#else
 	/* timegm reserves the right to modify it by not taking a const tm */
 	return timegm(&copy) - dtx->utc_offset;
+#endif
 }
 
 time_t dbi_result_get_datetime(dbi_result Result, const char *fieldname) {
